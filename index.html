<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RiskMaster 控仓助手</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: sans-serif; -webkit-tap-highlight-color: transparent; background: #0f172a; color: #e2e8f0; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .tab-active { background: #eab308; color: #0f172a; font-weight: bold; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div class="w-full max-w-md space-y-4">
        <div class="flex bg-slate-900 p-1 rounded-xl border border-white/5">
            <button id="btnStd" onclick="setAcc('std')" class="flex-1 py-2 text-xs rounded-lg tab-active">美金账户</button>
            <button id="btnCent" onclick="setAcc('cent')" class="flex-1 py-2 text-xs rounded-lg text-slate-500">美分账户</button>
        </div>

        <div class="glass rounded-3xl p-6 space-y-4 shadow-2xl">
            <div>
                <label class="text-[11px] text-slate-400 block mb-1">单笔预设亏损 (USD)</label>
                <input type="number" id="risk" value="100" class="w-full bg-slate-900/50 rounded-xl p-3 text-xl font-bold text-white outline-none border border-white/10">
            </div>
            <div>
                <label class="text-[11px] text-slate-400 block mb-1">交易品种</label>
                <select id="sym" class="w-full bg-slate-900/50 rounded-xl p-3 text-white outline-none border border-white/10">
                    <option value="XAUUSD">黄金 (XAUUSD)</option>
                    <option value="EURJPY">欧日 (EURJPY)</option>
                    <option value="BTCUSD">比特币 (BTC)</option>
                </select>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <input type="number" id="entry" placeholder="入场价" class="bg-slate-900/50 rounded-xl p-3 text-white outline-none border border-white/10">
                <input type="number" id="stop" placeholder="止损价" class="bg-slate-900/50 rounded-xl p-3 text-white outline-none border border-white/10">
            </div>
            <div>
                <div class="flex justify-between text-[11px] text-slate-400 mb-1"><span>分仓单数</span><span id="sVal">1</span></div>
                <input type="range" id="sCount" min="1" max="10" value="1" class="w-full h-1 bg-slate-700 rounded-lg appearance-none accent-yellow-500">
            </div>
        </div>

        <div class="bg-yellow-500 rounded-3xl p-6 text-slate-900 shadow-xl">
            <div class="flex justify-between items-end">
                <div>
                    <p class="text-[11px] font-bold opacity-70 uppercase tracking-wider">单笔订单建议</p>
                    <div class="flex items-baseline gap-1">
                        <span id="resEach" class="text-6xl font-black tracking-tighter">0.00</span>
                        <span class="text-sm font-bold opacity-70">手</span>
                    </div>
                </div>
                <div class="text-right border-l border-slate-900/10 pl-4">
                    <p class="text-[10px] opacity-60">总共手数</p>
                    <p id="resTotal" class="text-xl font-black">0.00</p>
                    <p id="accLab" class="text-[9px] opacity-40 font-bold mt-1">STANDARD</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let rate = 154.50; let acc = 'std';
        async function getRate() { try { const r = await fetch('https://open.er-api.com/v6/latest/USD'); const d = await r.json(); if(d.rates.JPY) rate = d.rates.JPY; } catch(e){} calc(); }
        function setAcc(t) { acc = t; document.getElementById('btnStd').className = t=='std'?'flex-1 py-2 text-xs rounded-lg tab-active':'flex-1 py-2 text-xs rounded-lg text-slate-500'; document.getElementById('btnCent').className = t=='cent'?'flex-1 py-2 text-xs rounded-lg tab-active':'flex-1 py-2 text-xs rounded-lg text-slate-500'; document.getElementById('accLab').innerText = t=='cent'?'CENT (x100)':'STANDARD'; calc(); }
        const ids = ['risk','sym','entry','stop','sCount'];
        ids.forEach(id => document.getElementById(id).oninput = () => { if(id=='sCount') document.getElementById('sVal').innerText = document.getElementById(id).value; calc(); });
        function calc() {
            const rk = parseFloat(document.getElementById('risk').value)||0; const sy = document.getElementById('sym').value;
            const ey = parseFloat(document.getElementById('entry').value)||0; const sp = parseFloat(document.getElementById('stop').value)||0;
            const sc = parseInt(document.getElementById('sCount').value);
            if(!rk || !ey || !sp || ey==sp) return;
            const diff = Math.abs(ey - sp); let lots = 0;
            if(sy=="XAUUSD") lots = rk / (diff * 100);
            else if(sy=="EURJPY") lots = rk / ((diff * 100) * (1000 / rate));
            else lots = rk / diff;
            if(acc=='cent') lots *= 100;
            document.getElementById('resTotal').innerText = lots.toFixed(2);
            document.getElementById('resEach').innerText = (lots/sc).toFixed(2);
        }
        getRate();
    </script>
</body>
</html>
